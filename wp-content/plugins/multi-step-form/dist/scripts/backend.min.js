!function(S){"use strict";var r="#fw-wizard-container",t="#fw-elements-container";function h(){"console"in window&&console.log.apply(console,arguments)}function l(){"console"in window&&console.warn.apply(console,arguments)}function n(e,i){S('<div id="fw-alert" style="background-color:'+(i?"#4caf50":"#f44336")+'">'+e+"</div>").hide().appendTo("#wpbody-content").slideDown().delay(3e3).slideUp()}function k(e,i){var a='<div class="fw-radio-option-element" data-type="option">';return a+='<input type="text" class="fw-radio-option" placeholder="'+wizard.i18n.radio.option+" "+i+'" value="'+(""+e).replace(/\\/g,"\\\\").replace(/"/g,"&quot;")+'"></input>',a+='<div class="fw-remove-radio-option"><i class="fa fa-minus-circle" aria-hidden="true"></i></div></div>'}function o(e){h("block",e);var i,a,t,l,r,n,o,s,c,d,p,f,u,b,w,v,m='<div class="fw-step-block" data-type="'+e.type+'" >';switch(m+='<div class="fw-block-controls">',m+='<i class="fa fa-remove fw-remove-block" title="'+wizard.i18n.tooltips.removeBlock+'" aria-hidden="true"></i>',m+='<i class="fa fa-caret-up fw-toggle-block" aria-hidden="true"></i>',m+="</div>",m+=(i=e.type,a='<div class="fw-block-action fw-block-hndle">',a+='<i class="fa fa-arrows fw-move-block fw-block-hndle" aria-hidden="true"></i>',a+="<h4>"+i+"</h4>",a+="</div>"),m+='<div class="fw-block-fields">',e.type){case"radio":e.elements||(e.elements=[{type:"header",value:""},{type:"option",value:""}]),m+=function(e){h("radio",e);var i,a,t,l,r,n=0,o="";for(o+='<div class="fw-radio-option-container">',i=0,a=e.elements.length;i<a;i++)h("element",t=e.elements[i]),"option"===t.type?(1==i&&(o+="<label>"+wizard.i18n.radio.options+"</label>"),o+=k(t.value,1+n++)):o+=(l=t.value,r=void 0,r='<div class="fw-radio-option-element" data-type="header"><label>'+wizard.i18n.label+"</label>",r+='<input type="text" class="fw-radio-header fw-block-label" value="'+l+'"></input>',r+="</div>");return o+="</div>",o+='<button class="fw-radio-add"><i class="fa fa-plus" aria-hidden="true"></i> '+wizard.i18n.radio.addOption+"</button><br/>",o+='<label><input type="checkbox" class="fw-required"'+x(e.required)+"/> "+wizard.i18n.required+"</label>","true"==e.multichoice?o+='<label><input type="checkbox" class="fw-radio-multichoice" checked/>'+wizard.i18n.radio.multiple+' <i class="fa fa-info-circle" aria-hidden="true" title="'+wizard.i18n.tooltips.multiChoice+'"></i></label>':o+='<label><input type="checkbox" class="fw-radio-multichoice"/>'+wizard.i18n.radio.multiple+' <i class="fa fa-info-circle" aria-hidden="true" title="'+wizard.i18n.tooltips.multiChoice+'"></i></label>',o}(e);break;case"select":e.elements||(e.elements=[]),m+=function(e){h("select",e);var i=0,a="",t=wizard.i18n.select.placeholder?wizard.i18n.select.placeholder:"";for(a+='<div class="fw-select-option-container">',a+="<label>"+wizard.i18n.label+"</label>",a+='<input type="text" class="fw-block-label" value="'+e.label+'"></input>',a+="<label>"+t+"</label>",a+='<input type="text" class="fw-select-placeholder" value="'+e.placeholder+'"></input>',a+="<label>"+wizard.i18n.select.options+"</label>",a+='<textarea class="fw-select-options" rows="4" cols="50">',i=0;i<e.elements.length;i++)a+=e.elements[i]+"\n";return a+="</textarea>",a+="</div>",a+='<label><input type="checkbox" class="fw-select-search"'+x(e.search)+"/>"+wizard.i18n.select.search+"</label>",a+='<label><input type="checkbox" class="fw-required"'+x(e.required)+"/> "+wizard.i18n.required+"</label>"}(e);break;case"checkbox":m+=function(e){h("checkbox",e);var i="";return i+="<label>"+wizard.i18n.label+"</label>",i+='<input type="text" class="fw-text-label fw-block-label" placeholder="'+wizard.i18n.label+'" value="'+e.label+'"></input><br/>',i+='<label><input type="checkbox" class="fw-required"'+x(e.required)+"/>"+wizard.i18n.required+"</label>"}(e);break;case"text":m+=function(e){h("textInput",e);var i="";return i+="<label>"+wizard.i18n.label+"</label>",i+='<input type="text" class="fw-text-label fw-block-label" placeholder="'+wizard.i18n.label+'" value="'+e.label+'"></input><br/>',i+='<label><input type="checkbox" class="fw-required"'+x(e.required)+"/>"+wizard.i18n.required+"</label>"}(e);break;case"email":m+=(w=e,v="",v+="<label>"+wizard.i18n.label+"</label>",v+='<input type="text" class="fw-text-label fw-block-label" placeholder="'+wizard.i18n.label+'" value="'+w.label+'"></input><br/>',v+='<label><input type="checkbox" class="fw-required"'+x(w.required)+"/>"+wizard.i18n.required+"</label>");break;case"numeric":m+=(u=e,b="",b+="<label>"+wizard.i18n.label+"</label>",b+='<input type="text" class="fw-text-label fw-block-label" placeholder="'+wizard.i18n.label+'" value="'+u.label+'"></input><br/>',b+='<label><input type="checkbox" class="fw-required"'+x(u.required)+"/>"+wizard.i18n.required+"</label>",b+="<label>"+wizard.i18n.numeric.minimum+"</label>",b+='<input type="text" class="fw-numeric-minimum fw-block-label" placeholder="'+wizard.i18n.numeric.no_minimum+'" value="'+(u.minimum?u.minimum:"")+'" pattern="-?\\d*"></input><br/><br/>',b+="<label>"+wizard.i18n.numeric.maximum+"</label>",b+='<input type="text" class="fw-numeric-maximum fw-block-label" placeholder="'+wizard.i18n.numeric.no_maximum+'" value="'+(u.maximum?u.maximum:"")+'" pattern="-?\\d*"></input><br/>');break;case"file":m+=(p=e,f="",f+="<label>"+wizard.i18n.label+"</label>",f+='<input type="text" class="fw-text-label fw-block-label" placeholder="'+wizard.i18n.label+'" value="'+p.label+'"></input><br/>',f+='<label><input type="checkbox" class="fw-file-multi"'+x(p.multi)+"/>"+wizard.i18n.multifile+"</label>",f+='<label><input type="checkbox" class="fw-required"'+x(p.required)+"/>"+wizard.i18n.required+"</label>");break;case"date":m+=(c=e,d="",d+="<label>"+wizard.i18n.label+"</label>",d+='<input type="text" class="fw-text-label fw-block-label" placeholder="'+wizard.i18n.label+'" value="'+c.label+'"></input><br/>',d+="<label>"+wizard.i18n.dateformat+'<a target="_blank" href="http://t1m0n.name/air-datepicker/docs/#sub-section-9"><i class="fa fa-info-circle" aria-hidden="true" title="'+wizard.i18n.tooltips.dateformat+'"></i></a></label>',d+='<input type="text" class="fw-date-format fw-block-label" placeholder="'+wizard.i18n.dateformat+'" value="'+(c.format?c.format:"yy-mm-dd")+'" ></input><br/>',d+='<label><input type="checkbox" class="fw-required"'+x(c.required)+"/>"+wizard.i18n.required+"</label>");break;case"textarea":m+=function(e){h("textArea",e);var i="";return i+="<label>"+wizard.i18n.label+"</label>",i+='<input type="text" class="fw-textarea-label fw-block-label" placeholder="'+wizard.i18n.label+'" value="'+e.label+'"></input><br/>',i+='<label><input type="checkbox" class="fw-required"'+x(e.required)+"/>"+wizard.i18n.required+"</label>"}(e);break;case"paragraph":m+=(o=e,s="",s+="<label>"+wizard.i18n.paragraph.textHtml+' <i class="fa fa-info-circle" aria-hidden="true" title="'+wizard.i18n.tooltips.paragraph+'"></i></label>',s+='<textarea class="fw-paragraph-text fw-block-label" placeholder="'+wizard.i18n.paragraph.text+'">'+(o.text?o.text:"")+"</textarea>",s+='<label style="display:none;"><input type="checkbox" class="fw-required"'+x(o.required)+"/>"+wizard.i18n.required+"</label>");break;case"regex":m+=(r=e,n="",n+="<label>"+wizard.i18n.label+"</label>",n+='<input type="text" class="fw-text-label fw-block-label" placeholder="'+wizard.i18n.label+'" value="'+r.label+'"></input><br/>',n+="<label>"+wizard.i18n.filter+"</label>",n+='<input type="text" class="fw-regex-filter fw-block-label" placeholder="'+wizard.i18n.filter+'" value="'+(r.filter?r.filter:"")+'"></input><br/>',n+="<label>"+wizard.i18n.filterError+"</label>",n+='<input type="text" class="fw-regex-error fw-block-label" placeholder="'+wizard.i18n.filterError+'" value="'+(r.customError?r.customError:"")+'"></input><br/>',n+='<label><input type="checkbox" class="fw-required"'+x(r.required)+"/>"+wizard.i18n.required+"</label>");break;case"registration":m+=(l="",l+='<label><input type="checkbox" class="fw-required"'+x((t=e).required)+"/>"+wizard.i18n.required+"</label>",l+='<p class="msfp-registration-info">'+wizard.i18n.registration.info+"</p>",l+='<label class="msfp-registration-option"><input type="checkbox" class="msfp-registration-email" checked disabled="disabled"/>'+wizard.i18n.registration.email+"</label>",l+='<label class="msfp-registration-option"><input type="checkbox" class="msfp-registration-username" checked disabled="disabled"/>'+wizard.i18n.registration.username+"</label>",l+='<label class="msfp-registration-option"><input type="checkbox" class="msfp-registration-password"'+x(t.password)+"/>"+wizard.i18n.registration.password+"</label>",l+='<label class="msfp-registration-option"><input type="checkbox" class="msfp-registration-firstname"'+x(t.firstname)+"/>"+wizard.i18n.registration.firstname+"</label>",l+='<label class="msfp-registration-option"><input type="checkbox" class="msfp-registration-lastname"'+x(t.lastname)+"/>"+wizard.i18n.registration.lastname+"</label>",l+='<label class="msfp-registration-option"><input type="checkbox" class="msfp-registration-website"'+x(t.website)+"/>"+wizard.i18n.registration.website+"</label>",l+='<label class="msfp-registration-option"><input type="checkbox" class="msfp-registration-bio"'+x(t.bio)+"/>"+wizard.i18n.registration.bio+"</label>")}return m+="</div>",m+='<div class="fw-clearfix"></div>',m+="</div>"}function s(e,i){h("part",e);var a='<div class="'+i+'">';return a+='<div class="fw-section-hndle"><i class="fa fa-arrows"></i></div>',a+='<input type="text" class="fw-part-title" value="'+e.title+'" placeholder="'+wizard.i18n.partTitle+'"></input>',a+='<div class="fw-remove-part" title="'+wizard.i18n.removeSection+'">',a+='<i class="fa fa-remove"></i>',a+='</div><div class="inside connectedSortable">',a+=function(e){var i,a,t="";for(i=0,a=e.length;i<a;i++)if("conditional"==e[i].type){t+=o(e[i].block);var l={prec_block_id:e[i].prec_block_id,prec_operator:e[i].prec_operator,prec_value:e[i].prec_value,visible:e[i].visible};t=t.slice(0,-6),t+='<input class="msf-block-meta" name="msf-block-meta-'+i+'" type="hidden" value="'+encodeURI(JSON.stringify(l))+'">',t+="</div>"}else t+=o(e[i]);return t}(e.blocks),a+='</div><div class="fw-add-element">',a+='<a href="#TB_inline?width=400&height=200&inlineId=fw-thickbox-content" class="thickbox"><i class="fa fa-plus"></i> '+wizard.i18n.addElement+"</a>",a+="</div>",a+="</div>"}function a(e,i){var a="fw-headline-"+i,t="fw-copy-text-"+i,l='<div class="fw-step"><div class="form-wrap">';return l+='<div class="input form-field">',l+='<label for="'+("fw-title-"+i)+'"><b>'+wizard.i18n.title+"</b>",l+='<i class="fa fa-info-circle" aria-hidden="true" title="'+wizard.i18n.tooltips.title+'"></i></label>',l+='<input type="text" class="fw-step-title" value="'+e.title+'"></input>',l+="</div>",l+='<div class="input form-field">',l+='<label for="'+a+'"><b>'+wizard.i18n.headline+"</b>",l+='<i class="fa fa-info-circle" aria-hidden="true" title="'+wizard.i18n.tooltips.headline+'"></i></label>',l+='<input type="text" class="fw-step-headline" value="'+e.headline+'"></input>',l+="</div>",l+='<div class="input form-field">',l+='<label for="'+t+'"><b>'+wizard.i18n.copyText+"</b>",l+='<i class="fa fa-info-circle" aria-hidden="true" title="'+wizard.i18n.copyText+'"></i></label>',l+='<input type="text" class="fw-step-copy_text" value="'+e.copy_text+'"></input>',l+="</div>",l+='<div class="fw-step-parts">'+function(e){var i,a=e.length,t='<div><div class="fw-parts-header"><h3>Sections</h3></div>';for(t+='<div class="fw-column-buttons">',t+='<button type="button" class="fw-button-one-column"><i class="fa fa-align-justify"></i></button>',t+='<button type="button" class="fw-button-two-columns"><i class="fa fa-align-justify"></i> <i class="fa fa-align-justify"></i></button>',t+="</div>",t+='<div class="fw-parts-container">',i=0,a=e.length;i<a;i++)t+=s(e[i],"fw-step-part");return t+="</div>",t+='<div class="fw-parts-footer">',t+='<a class="fw-add-part"><i class="fa fa-plus"></i> '+wizard.i18n.addSection+"</a>",t+="</div>",t+="</div>"}(e.parts)+"</div>",l+='</div><div class="fw-clearfix"></div></div>'}function c(e){var i='<div class="postbox">';return i+='<div class="fw-movediv hndle ui-sortable-handle"><i class="fa fa-arrows"></i></div>',i+='<h1 class="fw-step-h1 hndle ui-sortable-handle"><span>',i+=e.title+"</span></h1>",i+='<div class="fw-step-controls">',i+='<i class="fa fa-remove fw-remove-step" title="'+wizard.i18n.tooltips.removeStep+'" aria-hidden="true"></i>',i+='<i class="fa fa-caret-up fw-toggle-step" aria-hidden="true"></i>',i+='<i class="fa fa-files-o fw-duplicate-step" title="duplicate step" aria-hidden="true"></i>',i+="</div>",i+='<div class="fw-clearfix"></div>',i+=a(e),i+='<div class="fw-clearfix"></div>',i+="</div>"}function d(e){var i,a,t,l,r,n,o,s,c,d,p,f,u,b,w,v,m,h,k,g,x,y,z,q,_,C={};switch(C.type=e.attr("data-type")){case"radio":z=e,_=(q=C).elements=[],z.find(".fw-radio-option-element").each(function(e,i){var a,t,l;_.push((a=S(i),"option"===(l=(t={}).type=a.attr("data-type"))?t.value=a.find(".fw-radio-option").val():"header"===l&&(t.value=a.find(".fw-radio-header").val()),t))}),q.required=z.find(".fw-required").prop("checked"),q.multichoice=z.find(".fw-radio-multichoice").prop("checked");break;case"select":x=C,y=(g=e).find(".fw-select-options").val().split("\n"),x.required=g.find(".fw-required").prop("checked"),x.search=g.find(".fw-select-search").prop("checked"),x.label=g.find(".fw-block-label").val(),x.placeholder=g.find(".fw-select-placeholder").val(),x.elements=y.filter(function(e){return""!==e&&" "!==e});break;case"checkbox":h=e,(k=C).label=h.find(".fw-text-label").val(),k.required=h.find(".fw-required").prop("checked");break;case"text":v=e,(m=C).label=v.find(".fw-text-label").val(),m.required=v.find(".fw-required").prop("checked");break;case"email":b=e,(w=C).label=b.find(".fw-text-label").val(),w.required=b.find(".fw-required").prop("checked");break;case"numeric":f=e,(u=C).label=f.find(".fw-text-label").val(),u.required=f.find(".fw-required").prop("checked"),u.minimum=f.find(".fw-numeric-minimum").val(),u.maximum=f.find(".fw-numeric-maximum").val();break;case"file":d=e,(p=C).label=d.find(".fw-text-label").val(),p.required=d.find(".fw-required").prop("checked"),p.multi=d.find(".fw-file-multi").prop("checked");break;case"date":s=e,(c=C).label=s.find(".fw-text-label").val(),c.format=s.find(".fw-date-format").val(),c.required=s.find(".fw-required").prop("checked");break;case"textarea":n=e,(o=C).label=n.find(".fw-textarea-label").val(),o.required=n.find(".fw-required").prop("checked");break;case"paragraph":r=e,C.text=r.find(".fw-paragraph-text").val();break;case"regex":t=e,(l=C).label=t.find(".fw-text-label").val(),l.filter=t.find(".fw-regex-filter").val(),l.customError=t.find(".fw-regex-error").val(),l.required=t.find(".fw-required").prop("checked");break;case"registration":i=e,(a=C).required=i.find(".fw-required").prop("checked"),a.password=i.find(".msfp-registration-password").prop("checked"),a.firstname=i.find(".msfp-registration-firstname").prop("checked"),a.lastname=i.find(".msfp-registration-lastname").prop("checked"),a.website=i.find(".msfp-registration-website").prop("checked"),a.bio=i.find(".msfp-registration-bio").prop("checked")}return C}function p(e){var i={};i.title=e.find(".fw-part-title").val();var r=i.blocks=[];return e.find(".fw-step-block").each(function(e,i){var a,t,l=S(i);l.find(".msfp-conditional").prop("checked")?r.push(((t={type:"conditional"}).visible=(a=l).find(".msfp-conditional-visible").val(),t.prec_block_id=a.find(".msfp-conditional-prec-block-id").val(),t.prec_operator=a.find(".msfp-conditional-prec-op").val(),t.prec_value=a.find(".msfp-conditional-prec-value").val(),t.block=d(a),t)):r.push(d(l))}),i}function f(e){var i={};i.title=e.find(".fw-step-title").val(),i.headline=e.find(".fw-step-headline").val(),i.copy_text=e.find(".fw-step-copy_text").val();var a=i.parts=[];return e.find(".fw-step-part").each(function(e,i){a.push(p(S(i)))}),i}function u(e){var i,a,t,l=!0;return""===e.title?(l=!1,n(wizard.i18n.alerts.noFormTitle,!1)):l=function(e){for(var i=!0,a=0;a<e.length;a++)if(e[a].title)for(var t=0;t<e[a].parts.length;t++){""===e[a].parts[t].title&&(i=!1,n(wizard.i18n.alerts.noSectionTitle,!1));for(var l=0;l<e[a].parts[t].blocks.length;l++)e[a].parts[t].blocks[l]}else i=!1,n(wizard.i18n.alerts.noStepTitle,!1);return i}(e.wizard.steps)&&(i=e.wizard.settings,t=!0,(a=i.to)&&/^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/.test(a)?i.subject||(t=!1,S("#fw-nav-settings").trigger("click"),n(wizard.i18n.alerts.noSubject,!1)):(t=!1,S("#fw-nav-settings").trigger("click"),n(wizard.i18n.alerts.invalidEmail,!1)),t),l}function b(){var e,i=S(r),a=S(".fw-wizard-title").val(),t={wizard:{}};t.wizard.title=a,t.wizard.steps=[],t.wizard.settings=((e={}).thankyou=S(".fw-settings-thankyou").val(),e.to=S(".fw-mail-to").val(),e.frommail=S(".fw-mail-from-mail").val(),e.fromname=S(".fw-mail-from-name").val(),e.subject=S(".fw-mail-subject").val(),e.header=S(".fw-mail-header").val(),e.headers=S(".fw-mail-headers").val(),e);var l=i.find(".fw-step");l.each(function(e,i){l.length;t.wizard.steps.push(f(S(i)))}),t.wizard.steps.push(),u(t)&&(h("save",t),S.ajax({type:"POST",url:wizard.ajaxurl,dataType:"json",data:{action:"fw_wizard_save",data:t,nonce:wizard.nonce,id:wizard.id},success:function(e){void 0!==e.data.nonce&&(wizard.nonce=e.data.nonce),wizard.id=e.data.id,n(e.data.msg,e.success)},error:function(e){h("fail",arguments),h("response",e)}}))}function w(){S(".meta-box-sortables").sortable({opacity:.6,revert:!0,cursor:"move",handle:".hndle",tolerance:"pointer",placeholder:"fw-block-placeholder",start:function(e,i){var a=S(i.item).height();S(".fw-block-placeholder").height(a)},update:function(e,i){l("sortables update",e,i),S(i.item).removeAttr("style"),w(),v()}}),S(".fw-step-part .inside").sortable({opacity:.6,cursor:"move",connectWith:".connectedSortable",handle:".fw-block-hndle",tolerance:"intersect",placeholder:"fw-block-placeholder",revert:100,start:function(e,i){var a=S(i.item).height(),t=S(".fw-block-placholder");t.height(a),t.attr("data-type",i.item.attr("data-type"))},update:function(e,i){var a=S(i.item).attr("data-type"),t=-1;if(S(i.item).is(".fw-draggable-block"))if("registration"===a&&y())n("Only one registration block allowed!",!1),S(i.item).remove();else{var l=S(o({type:a,label:""}));S(i.item).replaceWith(l),t=S(".fw-step-block").index(l)}w(),v(),T(),msfp&&setupConditionals(t)}}),S(".fw-parts-container").sortable({opacity:.6,cursor:"move",connectWith:".fw-parts-container",handle:".fw-section-hndle",tolerance:"intersect",placeholder:"fw-section-placeholder",revert:100,start:function(e,i){var a=S(i.item).height();S(".fw-section-placeholder").height(a)},update:function(e,i){w(),v(),T()}});S(t+" .fw-draggable-block").draggable({connectToSortable:".fw-step-part .inside",revert:"invalid",helper:"clone",cursor:"move"}),S(r).find(".fw-step-title").on("change input",e)}function v(){S(".fa-info-circle").tooltip(),S(".fw-remove-step").tooltip(),S(".fw-duplicate-step").tooltip(),S(".fw-remove-part").tooltip(),S(".fw-remove-block").tooltip(),S(".hndle.ui-sortable-handle").tooltip()}function e(e){var i=S(this);h("titleOnChangeU",i.val()),i.closest(".postbox").find("h1 > span").html(i.val())}function m(e){e.find('.fw-radio-option-element[data-type="option"] > label').each(function(e,i){h("updateOptions",i),S(i).html("Option "+(e+1))})}function g(e){var i=S(".fw-step").length;if(i<5||msfp)if(i<10){var a=S(c(e));a.appendTo(S(r).find(".meta-box-sortables")),T(),w(),_(),0<i&&S("html, body").animate({scrollTop:S(document).height()-a.height()-180},500)}else n(wizard.i18n.alerts.onlyTen,!1);else n(wizard.i18n.alerts.onlyFive,!1)}function x(e){var i="";return"true"==e&&(i="checked"),i}function y(){var a=!1;return S(".fw-step-block").each(function(e,i){"registration"==S(i).attr("data-type")&&(a=!0)}),a}function z(){var e=S(this).closest(".postbox");!0===confirm(wizard.i18n.alerts.reallyDeleteStep)&&e.slideUp(700,function(){e.remove()})}function q(e){var i=S(e.target).closest(".fw-step-part");!0===confirm(wizard.i18n.alerts.reallyDeleteSection)&&i.slideUp(500,function(){i.remove()})}function _(){S(".thickbox").click(function(t){S("#fw-thickbox-radio").unbind("click").click(function(e){tb_remove();var i=S(o({type:"radio"}));S(t.target).parents(".fw-step-part").find(".inside").append(i),T(),msfp&&setupConditionals(i)}),S("#fw-thickbox-select").unbind("click").click(function(e){tb_remove();var i=S(o({type:"select",label:""}));S(t.target).parents(".fw-step-part").find(".inside").append(i),T(),msfp&&setupConditionals(i)}),S("#fw-thickbox-text").unbind("click").click(function(e){tb_remove();var i=S(o({type:"text",label:"",value:""}));S(t.target).parents(".fw-step-part").find(".inside").append(i),T(),msfp&&setupConditionals(i)}),S("#fw-thickbox-email").unbind("click").click(function(e){tb_remove();var i=S(o({type:"email",label:"",value:""}));S(t.target).parents(".fw-step-part").find(".inside").append(i),T(),msfp&&setupConditionals(i)}),S("#fw-thickbox-numeric").unbind("click").click(function(e){tb_remove();var i=S(o({type:"numeric",label:"",value:"",minimum:"",maximum:""}));S(t.target).parents(".fw-step-part").find(".inside").append(i),T(),msfp&&setupConditionals(i)}),S("#fw-thickbox-fileupload").unbind("click").click(function(e){tb_remove();var i=S(o({type:"file",label:"",value:""}));S(t.target).parents(".fw-step-part").find(".inside").append(i),T()}),S("#fw-thickbox-textarea").unbind("click").click(function(e){tb_remove();var i=S(o({type:"textarea",label:"",value:""}));S(t.target).parents(".fw-step-part").find(".inside").append(i),T(),msfp&&setupConditionals(i)}),S("#fw-thickbox-date").unbind("click").click(function(e){tb_remove();var i=S(o({type:"date",label:"",format:"yy-mm-dd"}));S(t.target).parents(".fw-step-part").find(".inside").append(i),T(),msfp&&setupConditionals(i)}),S("#fw-thickbox-paragraph").unbind("click").click(function(e){tb_remove();var i=S(o({type:"paragraph",text:""}));S(t.target).parents(".fw-step-part").find(".inside").append(i),T(),msfp&&setupConditionals(i)}),S("#fw-thickbox-regex").unbind("click").click(function(e){tb_remove();var i=S(o({type:"regex",label:"",filter:"",customError:""}));S(t.target).parents(".fw-step-part").find(".inside").append(i),T(),msfp&&setupConditionals(i)}),S("#fw-thickbox-registration").unbind("click").click(function(e){tb_remove();var i=S(o({type:"registration",label:"",value:""})),a=S(t.target).parents(".fw-step-part");y()?n("Only one registration block allowed!",!1):a.find(".inside").append(i),T()})})}function C(e){-1!=S("input[type=text]").index(S(e.target))&&(-1==S.inArray(e.keyCode,[37,38,39,40,48,49,50,51,52,53,54,55,56,57,58,96,97,98,99,100,101,102,103,104,105,8,13,189])||189==e.keyCode&&-1!=S(e.target).val().indexOf("-")||198==e.keyCode&&0!=S(e.target).val().length)&&e.preventDefault()}function T(){S(".fw-element-step").unbind("click").click(function(e){g({title:"",headline:"",copy_text:"",parts:[{title:"",blocks:[]}]})}),S(".fw-duplicate-step").unbind("click").click(function(e){var i,a=S(this).parent().parent().find(".fw-step");(i=f(a)).title+=" (COPY)",g(i)}),S(".fw-add-part").unbind("click").click(function(e){var i,a;i=e.target,a=s({title:"",blocks:[]},"fw-step-part"),S(i).closest(".fw-step-parts").find(".fw-parts-container").append(a),S(".fw-remove-part").click(function(e){q(e)}),_(),w()}),S(".fw-toggle-step").unbind("click").click(function(e){S(this).parent().parent().find(".fw-step").slideToggle(),S(this).toggleClass("fw-icon-rotated")}),S(".fw-remove-part").unbind("click").click(function(e){q(e)}),S(".fw-remove-block").unbind("click").click(function(e){var i,a;i=S(e.target).closest(".fw-step-block"),a=i.find(".fw-block-label").val(),!0===confirm(wizard.i18n.alerts.reallyDeleteBlock+"\n\n"+a)&&i.slideUp(300,function(){i.remove()})}),S(".fw-toggle-block").unbind("click").click(function(e){var i=S(this).parent().parent();if(i.toggleClass("fw-block-collapsed"),i.hasClass("fw-block-collapsed")){var a=i.find(".fw-block-label").val();i.find("h4").text(a),S(this).addClass("fw-icon-rotated")}else{var t=i.data("type");i.find("h4").text(t),S(this).removeClass("fw-icon-rotated")}})}S(document).ready(function(){try{var e=JSON.parse(wizard.json),i=S(r);e.wizard.title?S(".fw-wizard-title").val(e.wizard.title):S(".fw-wizard-title").val("My Multi Step Form"),function(e){var i,a,t='<div class="postbox-container"><div class="metabox-holder"><div class="meta-box-sortables">';for(i=0,a=e.length;i<a;i++)t+=c(e[i]);t+="</div>",t+='<a class="fw-element-step"><i class="fa fa-plus"></i> '+wizard.i18n.addStep+"</a>",t+="</div></div>",S(r).html(t)}(e.wizard.steps&&0<e.wizard.steps.length?e.wizard.steps:[{title:"",headline:"",copy_text:"",parts:[{title:"",blocks:[]}]}]),(a=e.wizard.settings)&&(a.thankyou&&S(".fw-settings-thankyou").val(a.thankyou),a.subject&&S(".fw-mail-subject").val(a.subject),a.to&&S(".fw-mail-to").val(a.to),a.frommail&&S(".fw-mail-from-mail").val(a.frommail),a.fromname&&S(".fw-mail-from-name").val(a.fromname),a.header&&S(".fw-mail-header").val(a.header),a.headers&&S(".fw-mail-headers").val(a.headers)),S(".fw-button-save").click(b),S(window).scroll(function(){S(".nav-tab-wrapper").height()+19<S(this).scrollTop()?S(t).addClass("fw-sticky"):S(t).removeClass("fw-sticky")}),i.on("click",".postbox .handlediv",function(){S(this).closest(".postbox").toggleClass("closed")}),i.on("click",".fw-radio-add",function(){var e=S(this).prev(".fw-radio-option-container"),i=k("",e.children(".fw-radio-option-element").length);S(i).appendTo(e),m(e)}),i.on("click",".fw-remove-radio-option",function(){h("remove on click");var e=S(this),i=e.closest(".fw-radio-option-container");e.closest(".fw-radio-option-element").remove(),m(i)}),i.on("keydown",".fw-numeric-minimum",C),i.on("keydown",".fw-numeric-maximum",C),i.on("click",".fw-remove-step",z),w(),v(),_(),T(),S("#fw-nav-settings").click(function(e){S("#fw-nav-steps").toggleClass("nav-tab-active"),S("#fw-nav-settings").toggleClass("nav-tab-active"),S(r).hide(),S(t).hide(),S(".fw-mail-settings-container").show()}),S("#fw-nav-steps").click(function(e){S("#fw-nav-steps").toggleClass("nav-tab-active"),S("#fw-nav-settings").toggleClass("nav-tab-active"),S(".fw-mail-settings-container").hide(),S(r).show(),S(t).show()}),S("#fw-elements-modal").dialog({dialogClass:"wp-dialog",modal:!0,autoOpen:!1,closeOnEscape:!0,buttons:{Close:function(){S(this).dialog("close")}}})}catch(e){l(e)}var a})}(jQuery);
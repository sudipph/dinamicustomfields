jQuery(document).ready(function(M){"use strict";var c={},i=[ajax.i18n.errors.requiredFields,ajax.i18n.errors.requiredField,ajax.i18n.errors.someRequired+"<br>"+ajax.i18n.errors.checkFields];function p(){window.console&&console.log.apply(console,arguments)}function w(){window.console&&console.warn.apply(console,arguments)}function s(a,e){a.find('.fw-wizard-step[data-stepId="'+e+'"]').removeClass("fw-current"),a.find('.fw-wizard-step-header[data-stepId="'+e+'"]').removeClass("fw-current"),a.find('.fw-progress-step[data-id="'+e+'"]').removeClass("fw-active"),a.find('.fwp-progress-bar .fwp-circle[data-id="'+e+'"]').removeClass("fwp-active")}function d(a,e){a.find('.fw-wizard-step[data-stepId="'+e+'"]').addClass("fw-current"),a.find('.fw-wizard-step-header[data-stepId="'+e+'"]').addClass("fw-current"),a.find('.fw-progress-step[data-id="'+e+'"]').addClass("fw-active")}function l(){var a=k(M(this)),e=C(a),t=parseInt(e,10),i=a.find('.fwp-progress-bar .fwp-circle[data-id="'+e+'"]'),r=a.find('.fwp-progress-bar .fwp-bar[data-id="'+(t-1)+'"]');a.find('.fw-progress-step[data-id="'+(t-1)+'"]').removeClass("fw-visited"),a.find('.fw-progress-step[data-id="'+e+'"]').removeClass("fw-visited"),i.removeClass("fwp-done"),5==t&&a.find(".fw-progress-bar").removeClass("fw-step-after-fifth"),i.find(".fwp-label").html(parseInt(e,10)+1),r.removeClass("fwp-active"),2<=t&&a.find('.fwp-progress-bar .fwp-bar[data-id="'+(t-2)+'"]').removeClass("fwp-done").addClass("fwp-active"),s(a,e--),a.find('.fwp-progress-bar .fwp-circle[data-id="'+e+'"]').find(".fwp-label").html(parseInt(e,10)+1),d(a,e),0===e&&a.find(".fw-button-previous").hide(),a.find(".fw-button-next").show()}function o(){var a=k(M(this)),e=C(a),t=parseInt(e,10),i=a.find('.fwp-progress-bar .fwp-circle[data-id="'+e+'"]'),r=a.find('.fwp-progress-bar .fwp-bar[data-id="'+e+'"]');L(e)&&(a.find('.fw-progress-step[data-id="'+e+'"]').addClass("fw-visited"),4==t&&a.find(".fw-progress-bar").addClass("fw-step-after-fifth"),i.removeClass("fwp-active").addClass("fwp-done"),i.find(".fwp-label").html("&#10003;"),r.addClass("fwp-active"),1<=t&&a.find('.fwp-progress-bar .fwp-bar[data-id="'+(t-1)+'"]').removeClass("fwp-active").addClass("fwp-done"),s(a,e++),d(a,e),e===x(a)-1&&a.find(".fw-button-next").hide(),a.find(".fw-button-previous").show(),M("html, body").animate({scrollTop:M("#multi-step-form").offset().top-100},500))}function P(a){return String(a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}function A(a,e,t,i,r){var s={};i?(s[t]=i,F(a,e).push(s)):"true"==r&&(s['<p class="fw-step-summary fw-summary-invalid">'+t]="</p>",F(a,e).push(s))}function r(a,e,t){var i,r,s,n,f,d,l,o,c,p,w,u,v,m,b,h,g,k,x,C,y,j,z,T,I,_,F,N,q,S,E,O,R,D=e.attr("data-required");switch(e.attr("data-type")){case"fw-email":case"fw-numeric":case"fw-date":case"fw-text":case"fw-regex":N=a,S=t,E=D,O=(q=e).find("h3").text(),R=q.find(".fw-text-input").val().trim(),A(N,S,O,R=P(R),E);break;case"fw-textarea":j=a,T=t,I=D,_=(z=e).find("h3").text(),F=z.find(".fw-textarea").val().trim(),A(j,T,_,F=(F=P(F)).replace(/\n/g,"<br/>\n"),I);break;case"fw-radio":h=a,k=t,x=D,C=(g=e).find("h3").text(),y="",g.find(".fw-choice").each(function(a,e){M(e).find("input").is(":checked")&&(""!=y&&(y+=", "),y+=M(e).find("label").text())}),A(h,k,C,y,x);break;case"fw-select":b=D,A(a,t,(m=e).find("h3").text(),m.find("select").select2("data")[0].text,b);break;case"fw-checkbox":o=a,p=t,w=D,v=(c=e).find("label").text(),c.find(".fw-checkbox").is(":checked")&&(u="yes"),c.hasClass("fw-block-invalid"),A(o,p,v,u,w);break;case"fw-registration":i=a,r=e,s=t,n=D,f=ajax.i18n.registration,d=r.find(".msfp-registration-input[data-id=username]").val(),l=r.find(".msfp-registration-input[data-id=email]").val(),A(i,s,f,d&&l?d+" ("+l+")":ajax.i18n.registrationFailed,n)}}function n(a,e,i){return a.find('.fw-wizard-step[data-stepId="'+e+'"]').find(".fw-step-part").each(function(a,e){var t=M(e).find(".fw-step-part-title").text().trim();M(e).find('.fw-step-block:not(.fw-step-block[style="display: none;"] > .fw-step-block):not(.msfp-block-conditional)').each(function(a,e){r(i,M(e),t)})}),""}function f(a){var e=document.createElement("div");e.innerHTML=a;for(var t=e.getElementsByTagName("script"),i=t.length;i--;)t[i].parentNode.removeChild(t[i]);return e.innerHTML}function u(){var t=[];return M(".fw-step-block[data-type=fw-file]").each(function(a,e){v(e,t)}),t}function v(a,e){for(var t=M(a).find("input")[0].files,i=0;i<t.length;i++)e.push(t[i].name)}function m(a){var e,t=x(a),i={};for(e=0;e<t;e++)n(a,e,i);return i}function b(a){var e,t="";for(e in a)t+='<div class="fw-step-summary-field"><div class="fw-step-summary-field-title">'+e+"</div>",t+='<div class="fw-step-summary">'+f(a[e])+"</div></div>";return t}function h(a){var e,t,i="";for(e=0,t=a.length;e<t;e++)i+=b(a[e]);return i}function g(a){var e=function(a){var e="",t=m(a);for(var i in t)e+='<div class="fw-step-summary-part">',e+='<p class="fw-step-summary-title">'+i+"</p>",e+=h(t[i]),e+="</div>";return e}(a),t=a.find(".fw-wizard-summary");t.empty(),t.append(e),M(".fw-toggle-summary").toggle(function(){M(".fw-wizard-summary").slideDown(),M(".fw-toggle-summary").text(ajax.i18n.hideSummary)},function(){M(".fw-wizard-summary").slideUp(),M(".fw-toggle-summary").text(ajax.i18n.showSummary)}),M(".fw-summary-invalid").length?t.prepend('<div class="fw-summary-alert">'+i[2]+"</div>"):M(".fw-summary-alert").remove()}function k(a){return a.closest(".fw-wizard")}function x(a){return a.attr("data-stepCount")}function C(a){return a.find(".fw-current").attr("data-stepId")}function y(a){return a.closest(".fw-wizard-step").attr("data-stepId")}function j(a){return a.closest(".fw-step-part").attr("data-partId")}function z(a){return a.closest(".fw-step-block").attr("data-blockId")}function T(a){var e=[].slice.call(arguments,1),t=0,i=e.length;if(p("args",e),"0"===e[0])throw new TypeError;for(;t<i;t++)a=I(a,e[t]);return a}function I(a,e){return a[e]||(a[e]={}),a[e]}function _(a,e){var t=y(e),i=j(e),r=z(e);return T(c,a.attr("id"),t,i,r)}function F(a,e){return a[e]||(a[e]=[]),a[e]}function N(){var a=M(this),e=k(a),t=a.prop("checked"),i=_(e,a),r=a.attr("data-id");t?i[r]="checked":delete i[r],g(e)}function q(){var a=M(this),e=a.attr("data-id"),t=a.closest(".fw-conditional");t.find(".fw-conditional-then").removeClass("fw-selected"),t.find('.fw-conditional-then[data-id="'+e+'"]').addClass("fw-selected")}function S(){var a,e,t,i,r,s,n,f,d,l=M(this),o=k(l);e=l,r=(a=o).attr("id"),s=e.attr("name"),n=z(e),f=M('.fw-radio[name="'+s+'"]'),d=!1,p("radios",f),f.each(function(a,e){n!==z(M(e))&&(d=!0)}),t=y(e),i=j(e),d?delete T(c,r,t)[i]:delete T(c,r,t,i)[n],g(a),_(o,l)[l.attr("data-id")]="checked",g(o)}function E(){var a=M(this),e=k(a),t=a.val(),i=a.attr("data-id");_(e,a)[i]=t,a.parents(".fw-step-block").removeClass("fw-block-invalid"),a.parents(".fw-step-block").find(".fw-block-invalid-alert").remove(),g(e)}function O(){var a=M(this),e=k(a),t=a.val(),i=a.attr("data-id");_(e,a)[i]=t,a.parents(".fw-step-block").removeClass("fw-block-invalid"),a.parents(".fw-step-block").find(".fw-block-invalid-alert").remove(),g(e)}function R(a){var e=a.find(".fw-text-input").val();return!(!e||!/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e.trim()))||(a.addClass("fw-block-invalid"),!1)}function D(a){var e=new RegExp(a.data("filter")),t=a.find(".fw-text-input").val();return!(!t||!e.test(t.trim()))||(a.addClass("fw-block-invalid"),!1)}function H(a){var e=a.find(".fw-text-input").val(),t=a.data("min"),i=a.data("max");if(e&&/^-?\d+$/.test(e.trim())){var r=parseInt(e,10);return NaN===r?(a.addClass("fw-block-invalid"),!1):void 0!==t&&NaN!==parseInt(t,10)&&parseInt(t,10)>r?(a.addClass("fw-block-invalid"),!1):!(void 0!==i&&NaN!==parseInt(i,10)&&parseInt(i,10)<r)||(a.addClass("fw-block-invalid"),!1)}return a.addClass("fw-block-invalid"),!1}function L(a){var C=!0,y=!0;return M('.fw-wizard-step[data-stepid="'+a+'"] .fw-step-block[data-required="true"]:visible').each(function(a,e){var t,i,r,s,n,f,d,l,o,c,p,w,u,v,m,b,h,g,k,x=M(e);switch(x.attr("data-type")){case"fw-radio":k=!1,(g=x).children(".fw-choice").find("input").each(function(a,e){M(e).is(":checked")&&(k=!0)}),k||g.addClass("fw-block-invalid"),C=k;break;case"fw-select":h=!1,(b=x).find("select").val()?h=!0:b.addClass("fw-block-invalid"),C=h;break;case"fw-textarea":C=!!(m=x).find(".fw-textarea").val()||(m.addClass("fw-block-invalid"),!1);break;case"fw-text":C=!!(v=x).find(".fw-text-input").val()||(v.addClass("fw-block-invalid"),!1);break;case"fw-email":C=R(x);break;case"fw-numeric":C=H(x);break;case"fw-file":C=!!(u=x).find(".fw-file-upload-input").val()||(u.addClass("fw-block-invalid"),!1);break;case"fw-date":C=!!(w=x).find(".fw-text-input").val()||(w.addClass("fw-block-invalid"),!1);break;case"fw-checkbox":C=!!(p=x).find(".fw-checkbox").prop("checked")||(p.addClass("fw-block-invalid"),!1);break;case"fw-submit":l=(d=x).find("[data-id=name]").val(),o=d.find("[data-id=email]").val(),c=!0,l&&o||(c=!!d.has("input")||(d.addClass("fw-block-invalid"),!1)),C=c;break;case"fw-registration":i=!0,r=(t=x).find("[data-id=username]"),s=t.find("[data-id=email]"),n=r.hasClass("msfp-reg-username-valid"),f=s.hasClass("msfp-reg-email-valid"),n||(t.addClass("fw-block-invalid"),r.removeClass("msfp-reg-username-valid"),r.addClass("msfp-registration-invalid"),i=!1),f||(t.addClass("fw-block-invalid"),s.removeClass("msfp-reg-email-valid"),s.addClass("msfp-registration-invalid"),i=!1),C=i;break;case"fw-regex":C=D(x)}C||(y=!1)}),M('.fw-wizard-step[data-stepid="'+a+'"] .fw-step-block[data-type="fw-email"]').each(function(a,e){var t=M(e);""!=t.find(".fw-text-input").val()&&((C=R(t))||(y=!1))}),M('.fw-wizard-step[data-stepid="'+a+'"] .fw-step-block[data-type="fw-numeric"]').each(function(a,e){var t=M(e);""!=t.find(".fw-text-input").val()&&((C=H(t))||(y=!1))}),M('.fw-wizard-step[data-stepid="'+a+'"] .fw-step-block[data-type="fw-regex"]').each(function(a,e){var t=M(e);""!=t.find(".fw-text-input").val()&&((C=D(t))||(y=!1))}),y||(M(".fw-block-invalid").each(function(a,e){if(M(e).find(".fw-block-invalid-alert").length<1)if("fw-registration"==M(e).attr("data-type"))M(e).append('<div class="fw-block-invalid-alert">'+ajax.i18n.errors.checkFields+"</div>");else if("fw-email"==M(e).attr("data-type"))M(e).append('<div class="fw-block-invalid-alert">'+ajax.i18n.errors.invalidEmail+"</div>");else if("fw-numeric"==M(e).attr("data-type"))M(e).append('<div class="fw-block-invalid-alert">'+ajax.i18n.errors.invalidNumeric+"</div>");else if("fw-regex"==M(e).attr("data-type")){var t=M(e).data("error-msg")||ajax.i18n.errors.invalidRegex;M(e).append('<div class="fw-block-invalid-alert">'+t+"</div>")}else M(e).append('<div class="fw-block-invalid-alert">'+i[1]+"</div>")}),function(a,e){M(".fw-alert-user").empty().removeClass("fw-alert-user-fail fw-alert-user-success"),e?M(".fw-alert-user").addClass("fw-alert-user-success").append('<i class="fa fa-check-circle" aria-hidden="true"></i>'):M(".fw-alert-user").addClass("fw-alert-user-fail").append('<i class="fa fa-times-circle" aria-hidden="true"></i>');M(".fw-alert-user").append(a).fadeIn().delay(2e3).fadeOut()}(i[0],!1)),y}function W(a){var e,t,i,r,s,n,f,d,l,o=[],c=M(this).closest(".fw-wizard");(function(a){M(".fw-block-invalid").each(function(a,e){M(e).removeClass("fw-block-invalid")});var t=!0;return M(".fw-wizard-step").each(function(a,e){M(e),L(a)||(t=!1)}),t})()&&(M(".fw-spinner").show(),e=m(c),o=u(),t=c.find('[data-id="email"]').first().val(),c.find("[data-type=fw-registration]")&&(l={},M(".msfp-registration-input").each(function(a,e){var t=M(e).attr("data-id");l[t]=M(e).val()}),i=l),r=e,s=t,n=o,f=i,d=M("#multi-step-form").attr("data-wizardid"),M(".fw-btn-submit").html('<i class="fa fa-spinner"></i> '+ajax.i18n.sending),M.post(ajax.ajaxurl,{action:"fw_send_email",id:d,fw_data:r,email:s,reg:f,attachments:n,nonce:ajax.nonce},function(a){var e=M(".fw-container").attr("data-redirect");e?(window.onbeforeunload=null,window.location.href=e):(M(".fw-btn-submit").addClass("fw-submit-success").html('<i class="fa fa-check-circle"></i> '+ajax.i18n.submitSuccess),M(".fw-btn-submit").unbind("click"))}).fail(function(a){M(".fw-btn-submit").addClass("fw-submit-fail").html('<i class="fa fa-times-circle"></i> '+ajax.i18n.submitError),w("response",a),w("responseText",a.responseText)}))}function Y(a,i){var e=M("#multi-step-form").attr("data-wizardid"),r=M(a.target).prop("files"),t=new FormData;t.append("action","fw_upload_file");for(var s=0;s<r.length;s++)t.append("file"+s,r[s]);t.append("id",e),t.append("nonce",ajax.nonce),i.find("i").removeClass("fa-upload fa-times-circle fa-check-circle").addClass("fa-spinner"),i.find("span").text(ajax.i18n.uploadingFile);var n=M(a.target).parent().parent();M.ajax({type:"POST",url:ajax.ajaxurl,data:t,contentType:!1,processData:!1,dataType:"json",success:function(a){if(M("#multi-step-form").length&&(window.onbeforeunload=function(){var a=u();return Z(a),"Your uploaded files were deleted from the server for security reasons."}),a.success){n.attr("data-uploaded","true"),i.find("i").removeClass("fa-times-circle fa-spinner").addClass(" fa-check-circle");for(var e="",t=0;t<r.length;t++)0<t&&(e+=", "),e+=r[t].name;i.find("span").html(e)}else i.find("i").removeClass("fa-spinner fa-check-circle").addClass("fa-times-circle"),i.find("span").html(a.error),w(a.error)},fail:function(a){}})}function Z(a){M.post(ajax.ajaxurl,{action:"fw_delete_files",filenames:a,nonce:ajax.nonce},function(a){a&&M("[data-type=fw-file]").each(function(a,e){var t=M(e).find("input");t.replaceWith(t.val("").clone(!0)),M(e).find("label > i").removeClass("fa-check-circle").addClass("fa-upload"),M(e).find("label > span").text(ajax.i18n.chooseFile),M(e).attr("data-uploaded","false")})}).fail(function(a){w("response",a),w("responseText",a.responseText)})}function $(){var r=M(".msfp-registration-input[data-id=email]"),s=M(".msfp-registration-input[data-id=username]");r.closest(".fw-step-block");r.on("input",function(a){var e,t,i;t=(e=r).closest(".fw-step-block"),i={action:"msfp_pre_validate_reg_email",email:e.val(),nonce:ajax.nonce},M.ajax({type:"POST",url:ajax.ajaxurl,data:i,dataType:"json",success:function(a){a.success?(e.removeClass("msfp-registration-invalid"),e.addClass("msfp-reg-email-valid"),e.next().next().remove(".fw-block-invalid-alert"),0<t.find(".msfp-reg-username-valid").length&&t.removeClass("fw-block-invalid")):(t.addClass("fw-block-invalid"),e.addClass("msfp-registration-invalid"),e.removeClass("msfp-reg-email-valid"),e.next().next().hasClass("fw-block-invalid-alert")||e.next().after('<div class="fw-block-invalid-alert">'+a.error+"</div>"))},fail:function(a){valid=!1,w("response",a),w("responseText",a.responseText)}})}),s.on("input",function(a){var e,t,i;t=(e=s).closest(".fw-step-block"),i={action:"msfp_pre_validate_reg_username",username:e.val(),nonce:ajax.nonce},M.ajax({type:"POST",url:ajax.ajaxurl,data:i,dataType:"json",success:function(a){a.success?(e.removeClass("msfp-registration-invalid"),e.addClass("msfp-reg-username-valid"),e.next().next().remove(".fw-block-invalid-alert"),0<t.find(".msfp-reg-email-valid").length&&t.removeClass("fw-block-invalid")):(t.addClass("fw-block-invalid"),e.removeClass("msfp-reg-username-valid"),e.addClass("msfp-registration-invalid"),e.next().next().hasClass("fw-block-invalid-alert")||e.next().after('<div class="fw-block-invalid-alert">'+a.error+"</div>"))},fail:function(a){valid=!1,w("response",a),w("responseText",a.responseText)}})})}function e(){var a=M(".fw-wizard");a.each(function(a,e){d(M(e),0)});var e,t,i,r,s,n=x(a),f=a.parent().outerWidth();(5<=n&&769<=f||500<=f)&&a.addClass("fw-large-container"),M('.fw-progress-step[data-id="0"]').addClass("fw-active"),M(".fw-button-previous").hide(),M(".fw-button-previous").click(l),M(".fw-button-next").click(o),"off"==M(".fw-wizard-summary").attr("data-showsummary")&&M(".fw-toggle-summary").remove(),M(".fw-select").each(function(a,e){M(e).data("search")?M(e).select2({allowClear:!0!==M(e).data("required"),placeholder:""}):M(e).select2({minimumResultsForSearch:1/0,allowClear:!0!==M(e).data("required"),placeholder:""})}),M(".fw-checkbox").change(N),M(".fw-radio").change(S),M(".fw-radio-conditional").change(q),M(".fw-text-input").on("change input",E),M(".fw-textarea").on("change input",E),M(".fw-checkbox, .fw-radio").on("change",function(){M(this).parents(".fw-step-block").removeClass("fw-block-invalid"),M(this).parents(".fw-step-block").find(".fw-block-invalid-alert").remove()}),M(".msfp-registration-input").change(E),M(".fw-select").on("change",O),M(".fw-file-upload-input").each(function(){var a=M(this),t=a.next("label"),i=t.html(),r=a.parent().parent();a.on("change",function(a){var e="";a.target.value&&(e=a.target.value.split("\\").pop()),e?Y(a,t):t.html(i)}),a.on("click",function(a){if(a.target.value){var e=[];v(r,e),Z(e)}}),a.on("focus",function(){a.addClass("has-focus")}).on("blur",function(){a.removeClass("has-focus")})}),e=M(".fw-datepicker-here").attr("data-dateformat"),M(".fw-datepicker-here").datepicker({dateFormat:e,changeMonth:!0,changeYear:!0}),M(".fw-btn-submit").click(W),t=M(".fw-progress-bar").attr("data-activecolor"),i=M(".fw-progress-bar").attr("data-donecolor"),r=M(".fw-progress-bar").attr("data-nextcolor"),s=M(".fw-progress-bar").attr("data-buttoncolor"),M("head").append('<style id="fw-colors"></style>'),t&&M("head").append("<style>.fw-active .progress, ul.fw-progress-bar li.fw-active:before{background:"+t+"!important;} [data-type=fw-checkbox] input[type=checkbox]:checked+label:before, ul.fw-progress-bar li.fw-active .fw-txt-ellipsis { color: "+t+" !important; } .fw-step-part { border-color: "+t+" !important; } .fw-step-summary-field { border-color: "+t+" !important; } </style>"),i&&M("head").append("<style>ul.fw-progress-bar .fw-active:last-child:before, .fw-progress-step.fw-visited:before{ background:"+i+" !important; } .fw-progress-step.fw-visited, ul.fw-progress-bar .fw-active:last-child .fw-txt-ellipsis, .fw-progress-step.fw-visited .fw-txt-ellipsis { color:"+i+" !important;} ul.fw-progress-bar li.fw-visited:after, .fw-progress-step.fw-visited .fw-circle, .fw-progress-step.fw-visited .fw-circle-1, .fw-progress-step.fw-visited .fw-circle-2{ background-color:"+i+" !important;}</style>"),r&&M("head").append("<style>ul.fw-progress-bar li:before{background:"+r+" !important;} .fw-progress-bar li.fw-active:after, li.fw-progress-step::after, .fw-circle, .fw-circle-1, .fw-circle-2{ background-color:"+r+" !important;} .fw-txt-ellipsis { color: "+r+" !important; } </style>"),s&&M("head").append("<style>.fw-button-previous, .fw-button-next, .fw-button-fileupload { background: "+s+" !important; }</style>"),$(),g(M(".fw-wizard"))}M(document).ready(function(a){M("#multi-step-form").length&&e()})});